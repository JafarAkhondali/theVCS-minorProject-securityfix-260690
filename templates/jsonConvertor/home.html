{% extends 'jsonConvertor/base.html' %}
{% load static %}

{% block title %}{{title}}{% endblock %}


{% block css %}
<style>
    @media only screen and (max-width: 770px) {
        .imageMedia {
            display: none;
        }
    }

    .textShow {
        position: relative;
        top: 0px;
        left: 0px;
        height: 570px;
        width: 100%;
        font-size: 1rem;
    }

    .content {
        position: absolute;
        top: 40%;
        left: 20%;
        border: green solid 1px;
    }
</style>
{%endblock%}



{% block body%}
<div class="page-content bg-white">
    <!--Team--->
    <div class="section-full bg-white content-inner">
        <div class="alert alert-success alert-dismissible fade show mt-0" role="alert" style="height:177px;width:100%">
            <div class="row">
                <div class="col-md-3">
                    <div class="imageMedia"
                        style="border-radius: 50%;height: 150px; width:150px ; background-color: white;">
                        <img class="ml-4 mt-3 " src="{% static 'images/projects/jsonConvertor/image1.png'%}" alt="">
                    </div>
                </div>
                <div class="col-md-6 text-center mt-5">
                    <h2 class="title">Text Processor</h2>
                </div>
                <div class="col-md-3 ">
                    <div class="imageMedia"
                        style="border-radius: 50%;height: 150px; width:150px ; background-color: white;">
                        <img class="ml-4 mt-4" style="height: 90px; width: 110px;"
                            src="{% static 'images/projects/jsonConvertor/image2.png'%}" alt="">
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">

            <div class="row dlab-team10-area">
                <div class="container-fluid">

                    <form action="" method="get">
                        <div class="row">

                            <div class="mt-5 col-md-4">
                                <div class="section-head text-black text-center">
                                    <h3 class="title text-success">Enter Text</h3>
                                </div>
                                <div class="textShow" id="input"></div>
                            </div>

                            <div class="col-md-4 mt-5">
                                <div class="section-head text-black text-center">
                                    <h3 class="title text-success">Select Option</h3>
                                </div>
                                <div class="section-full bg-white content-inner overlay-black-dark bg-img-fix text-white"
                                    style='background-image:url(/static/images/projects/jsonConvertor/bg.jpg);'>
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div
                                                    class="section-content box-sort-in m-b10 p-b0 button-example m-b30 ">
                                                    <div class="row">
                                                        <div class="col-md-12 col-lg-12">
                                                            <ul class="list-box" style="list-style-type: none;">
                                                                <li>
                                                                    <div class="form-check">
                                                                        <input class="form-check-input" type="checkbox"
                                                                            id="punctuationRemover">
                                                                        <label class="form-check-label"
                                                                            for="punctuationRemover">
                                                                            Punctuation Remover
                                                                        </label>
                                                                    </div>
                                                                </li>

                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="section-content box-sort-in  button-example m-b30 text-center">
                                            <button class="site-button button-lg green radius-xl  m-r15" type="button"
                                                onclick="processText()">Process</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-5 col-md-4 mb-5">
                                <div class="section-head text-black text-center">
                                    <h3 class="title text-success">Processed</h3>
                                </div>
                                <div class="textShow" id="output"></div>
                            </div>

                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>
    <!--Team End--->
</div>
{%endblock%}


{% block script %}
<script src="{%static 'js/ace/ace.js'%}"></script>
<script>
    $(document).ready(function () {
        var editor;
        $('.textShow').each(function (index) {
            editor = ace.edit(this);
            editor.autoIndent(true);
            editor.setTheme("ace/theme/dracula");
            const nmode = "ace/mode/tex";
            editor.session.setMode(nmode);
        });
        editor.setReadOnly(true);
    })

    function processText() {
        var editor = ace.edit("input");
        var text = editor.getSession().getValue();
        editor = ace.edit("output");

        const options = {
            "punctuationRemover": "{%url 'punctuationRemover'%}",
        }

        for (const key in options) {

            if ($("#" + key).prop("checked")) {
                const url = options[key];
                
                $.post(url, {
                    text: text,
                    csrfmiddlewaretoken: '{{csrf_token}}',
                }, function (data, status) {
                    if (!data || data.length == 0) return;
                    data = JSON.parse(data)
                    console.log(data);
                    text = data["text"]
                    editor.session.insert(editor.getCursorPosition(), text)
                })
            }
        }
    }
</script>
{%endblock%}